<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ðŸ¦Œ Moose Fishing Adventure</title>
  <style>
    body { font-family: sans-serif; background: #87CEEB; margin:0; padding:0; }
    #nav { background: #556B2F; padding: 10px; text-align: center; }
    #nav button { margin: 0 5px; padding: 8px 16px; color: #fff; background: #6B8E23; border:none; cursor:pointer; }
    #nav button.active { background: #8FBC8F; }
    #view > div { display: none; padding: 10px; }
    #view > div.active { display: block; }
    #gameCanvas { background: #ADD8E6; display: block; margin: 10px auto; border: 2px solid #333; }
    #tankList button, #raceSelect, #battleSelect, #shopSelect { margin:5px; }
    table { margin:10px auto; border-collapse: collapse; }
    th, td { border:1px solid #333; padding:5px 10px; }
  </style>
</head>
<body>
  <h1 style="text-align:center;">ðŸ¦Œ Moose Fishing Adventure</h1>
  <div id="nav">
    <button id="btnFish" class="active">Fish</button>
    <button id="btnTank">Tank</button>
    <button id="btnRace">Race</button>
    <button id="btnBattle">Battle</button>
    <button id="btnShop">Shop</button>
  </div>
  <div id="view">
    <!-- Fishing View -->
    <div id="viewFish" class="active">
      <canvas id="gameCanvas" width="600" height="400"></canvas>
      <p style="text-align:center;">
        Click to cast (bait: <span id="lblBait">0</span>).<br>
        Rod: <span id="lblRod">Basic</span>, Hook: <span id="lblHook">Basic</span>, Tackle: <span id="lblTackle">Basic</span>
      </p>
    </div>
    <!-- Tank View -->
    <div id="viewTank">
      <h2>Your Fish Tank (<span id="tankCount">0</span>/10)</h2>
      <div id="tankList"></div>
    </div>
    <!-- Race View -->
    <div id="viewRace">
      <h2>Fish Race</h2>
      <select id="raceSelect"></select>
      <button id="btnRaceStart">Start Race</button>
      <p id="raceResult"></p>
    </div>
    <!-- Battle View -->
    <div id="viewBattle">
      <h2>Fish Battle</h2>
      <select id="battleSelect"></select>
      <button id="btnBattleStart">Start Battle</button>
      <p id="battleResult"></p>
    </div>
    <!-- Shop View -->
    <div id="viewShop">
      <h2>Shop</h2>
      <p>Gold: <span id="lblGold">0</span></p>
      <h3>Supplies</h3>
      <button data-item="fishFood" data-cost="10">Buy Fish Food (10g)</button>
      <button data-item="bait" data-cost="5">Buy Bait (5g)</button>
      <h3>Gear</h3>
      <button data-item="rod:Fiberglass" data-cost="50">Buy Fiberglass Rod (50g)</button>
      <button data-item="rod:Magnet" data-cost="100">Buy Magnet Rod (100g)</button>
      <button data-item="hook:Sharp" data-cost="30">Buy Sharp Hook (30g)</button>
      <button data-item="hook:SuperSharp" data-cost="60">Buy SuperSharp Hook (60g)</button>
      <button data-item="tackle:Spinner" data-cost="20">Buy Spinner Tackle (20g)</button>
      <button data-item="tackle:Lure" data-cost="40">Buy Lure Tackle (40g)</button>
      <h3>Sell Fish</h3>
      <div id="shopSellList"></div>
    </div>
  </div>
<script>
// --- Data & Classes ---
class Fish {
  constructor(name) {
    this.name = name;
    this.exp = 0;
    this.lv = 1;
    this.maxHp = 50;
    this.hp = this.maxHp;
    this.str = 10;
    this.def = 5;
    this.spd = 5;
  }
  gainExp(x) {
    this.exp += x;
    while(this.exp >= this.lv * 20) {
      this.exp -= this.lv * 20;
      this.lv++;
      this.maxHp += 10;
      this.hp = this.maxHp;
      this.str += 2;
      this.def += 1;
      this.spd += 1;
    }
  }
}

const player = {
  tank: [],
  bait: 10,
  fishFood: 5,
  gold: 100,
  rod: 'Basic', hook: 'Basic', tackle: 'Basic'
};
const fishNames = ['Goldfin','Carpzilla','Trouticus','Bassbeard'];

// --- Utils ---
function updateAll() {
  document.getElementById('lblBait').textContent = player.bait;
  document.getElementById('lblRod').textContent = player.rod;
  document.getElementById('lblHook').textContent = player.hook;
  document.getElementById('lblTackle').textContent = player.tackle;
  document.getElementById('lblGold').textContent = player.gold;
  renderTank();
  renderRaceList();
  renderBattleList();
  renderShopSell();
}

// --- View Navigation ---
const views=['Fish','Tank','Race','Battle','Shop'];
views.forEach(v=>{
  document.getElementById('btn'+v).onclick=()=>{
    views.forEach(x=>{
      document.getElementById('btn'+x).classList.remove('active');
      document.getElementById('view'+x).classList.remove('active');
    });
    document.getElementById('btn'+v).classList.add('active');
    document.getElementById('view'+v).classList.add('active');
    updateAll();
  };
});

// --- Fishing Logic ---
const canvas=document.getElementById('gameCanvas'), ctx=canvas.getContext('2d');
let hookPos={x:300,y:80,dy:5,dropping:false};
function drawFishing(){
  ctx.clearRect(0,0,600,400);
  // water
  ctx.fillStyle='#ADD8E6'; ctx.fillRect(0,100,600,300);
  // boat & moose head
  ctx.fillStyle='saddlebrown'; ctx.fillRect(250,30,100,20);
  ctx.fillStyle='#8B4513'; ctx.beginPath(); ctx.arc(300,60,20,0,2*Math.PI); ctx.fill();
  ctx.strokeStyle='#8B4513'; ctx.lineWidth=4;
  ctx.beginPath(); ctx.moveTo(290,50); ctx.lineTo(270,30); ctx.moveTo(310,50); ctx.lineTo(330,30); ctx.stroke();
  // hook drop
  if(hookPos.dropping){ hookPos.y+=hookPos.dy; if(hookPos.y>380) hookPos.dropping=false; }
  ctx.strokeStyle='#555'; ctx.lineWidth=2;
  ctx.beginPath(); ctx.moveTo(300,80); ctx.lineTo(hookPos.x,hookPos.y); ctx.stroke();
  ctx.fillStyle='#555'; ctx.beginPath(); ctx.arc(hookPos.x,hookPos.y,5,0,2*Math.PI); ctx.fill();
}
canvas.onclick=e=>{
  if(!hookPos.dropping && player.bait>0){
    const rect=canvas.getBoundingClientRect();
    hookPos.x=e.clientX-rect.left;
    hookPos.y=80; hookPos.dropping=true;
    player.bait--;
    attemptCatch();
    updateAll();
  }
};
function attemptCatch(){
  // base chance
  let chance=0.2;
  // gear bonuses
  const rodBonus={'Basic':0,'Fiberglass':0.1,'Magnet':0.2}[player.rod];
  const hookBonus={'Basic':0,'Sharp':0.05,'SuperSharp':0.1}[player.hook];
  const tackleBonus={'Basic':0,'Spinner':0.05,'Lure':0.1}[player.tackle];
  chance += rodBonus + hookBonus + tackleBonus;
  if(Math.random()<chance){
    if(player.tank.length<10){
      let f=new Fish(fishNames[Math.floor(Math.random()*fishNames.length)]);
      player.tank.push(f);
      alert('Caught '+f.name+'!');
    } else alert('Tank full!');
  } else alert('No catch');
}

// --- Tank View ---
function renderTank(){
  document.getElementById('tankCount').textContent = player.tank.length;
  const div=document.getElementById('tankList'); div.innerHTML='';
  player.tank.forEach((f,i)=>{
    let btn=document.createElement('button');
    btn.textContent = `${f.name} (Lv${f.lv})`;
    btn.onclick = ()=> showStats(i);
    div.appendChild(btn);
  });
}
function showStats(i){
  let f=player.tank[i];
  alert(`${f.name}\nLevel: ${f.lv}\nEXP: ${f.exp}/${f.lv*20}\nHP: ${f.hp}/${f.maxHp}\nSTR: ${f.str}\nDEF: ${f.def}\nSPD: ${f.spd}`);
}

// --- Race View ---
function renderRaceList(){
  const sel=document.getElementById('raceSelect'); sel.innerHTML='';
  player.tank.forEach((f,i)=>{
    let opt=document.createElement('option'); opt.value=i;
    opt.text=`${f.name} (SPD:${f.spd})`;
    sel.add(opt);
  });
}
document.getElementById('btnRaceStart').onclick=()=>{
  const idx=+document.getElementById('raceSelect').value;
  if(isNaN(idx)) return alert('No fish');
  let f=player.tank[idx];
  let gained=Math.floor(Math.random()*f.spd + f.lv);
  f.gainExp(gained);
  document.getElementById('raceResult').textContent =
    `${f.name} raced and gained ${gained} EXP!`;
  updateAll();
};

// --- Battle View ---
function renderBattleList(){
  const sel=document.getElementById('battleSelect'); sel.innerHTML='';
  player.tank.forEach((f,i)=>{
    let opt=document.createElement('option'); opt.value=i;
    opt.text=`${f.name} (HP:${f.hp}/${f.maxHp})`;
    sel.add(opt);
  });
}
document.getElementById('btnBattleStart').onclick=()=>{
  const idx=+document.getElementById('battleSelect').value;
  if(isNaN(idx)) return alert('No fish');
  let f=player.tank[idx];
  let enemy=new Fish('Wildfin');
  // simple turn-based
  while(f.hp>0 && enemy.hp>0){
    enemy.hp -= Math.max(1, f.str - enemy.def);
    if(enemy.hp<=0) break;
    f.hp -= Math.max(1, enemy.str - f.def);
  }
  if(f.hp>0){ f.gainExp(20); alert(`${f.name} won battle!`); }
  else { alert(`${f.name} lost battle.`); }
  f.hp = f.maxHp;
  updateAll();
};

// --- Shop View ---
// Supplies & Gear purchase
document.querySelectorAll('#viewShop button[data-item]').forEach(btn=>{
  btn.onclick = ()=>{
    const [type,value] = btn.dataset.item.split(':');
    const cost = +btn.dataset.cost;
    if(player.gold < cost) return alert('Not enough gold');
    player.gold -= cost;
    if(type==='fishFood' || type==='bait') player[type]++;
    else player[type] = value;
    updateAll();
  };
});
// Sell fish
function renderShopSell(){
  const div=document.getElementById('shopSellList'); div.innerHTML='';
  player.tank.forEach((f,i)=>{
    let btn=document.createElement('button');
    let price = f.lv * 20;
    btn.textContent = `Sell ${f.name} (Lv${f.lv}) for ${price}g`;
    btn.onclick = ()=>{
      player.gold += price;
      player.tank.splice(i,1);
      updateAll();
    };
    div.appendChild(btn);
  });
}

// --- Initialize ---
updateAll();
(function loop(){
  if(document.getElementById('viewFish').classList.contains('active')) drawFishing();
  requestAnimationFrame(loop);
})();
</script>
</body>
</html>
